 <!-- 
    Description of project
-->
 
 <html>
  <head>
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="js/go-button.js"></script>
    <script src="js/grabbing.js"></script>
    <script src="js/reset-button.js"></script>
    <script src="https://unpkg.com/aframe-physics-system@1.4.0/dist/aframe-physics-system.min.js"></script>
    <script src="js/done.js"></script>
    <script src="js/new-geo.js"></script>

  </head>
    <body>
      <a-scene id= "scen" physics="friction: 0.1">
        <a-entity id="rig" position="0 -1 2" >
          <a-entity id="camera" camera look-controls wasd-controls>
            <a-entity geometry="primitive: plane; height: 0.2; width: 0.2" position="0 0 -1"
            material="color: gray; opacity: 0.5"></a-entity>

          </a-entity>
          <a-entity cursor="rayOrigin:mouse;"
                    raycaster="far:20; interval:100; objects:.clickable;">
          <a-entity oculus-touch-controls="hand: left"></a-entity>
          <a-entity oculus-touch-controls="hand: right"></a-entity>
          </a-entity>
        </a-entity>

        <a-assets>
          <img id="skyTexture" src="assets/textures/rocky.jpg">
          <a-asset-item id="corkboardObj" src="assets/models/CorkBoard.obj"></a-asset-item>

          <a-asset-item id="bucketObj" src="assets/models/Bucket.obj"></a-asset-item>

          <a-asset-item id="tableObj" src="assets/models/Table.obj"></a-asset-item>
          
          <a-asset-item id="wallsObj" src="assets/models/Walls.obj"></a-asset-item>

          <a-asset-item id="ceilingObj" src="assets/models/Ceiling.obj"></a-asset-item>

          <a-asset-item id="pipeObj" src="assets/models/Pipe.obj"></a-asset-item>

          <a-asset-item id="sidepipeObj" src="assets/models/Side_Pipe.obj"></a-asset-item>

          <a-asset-item id="ventObj" src="assets/models/Vent.obj"></a-asset-item>
  
        </a-assets>
        <a-sky id="background" src="#skyTexture"></a-sky>

        <a-entity id="player_ball"
          geometry="primitive: sphere; radius: 0.5"
                    material="color: #4CC3D9; shader: standard"
                    position="-7 9 -5"
                    rotation="0 0 0"
                    static-body>
        </a-entity>

        <a-entity id="done_button"
        class="clickable"
          geometry="primitive: box; width: 2; height: 0.75; depth: 0.5"
                    material="color: green; shader: standard"
                    position="-9.5 9 -5"
                    rotation="0 0 0"
                    
                    go-button="">
        </a-entity>

        <a-entity id="reset_button"
        class="clickable"
          geometry="primitive: box; width: 2; height: 0.75; depth: 0.5"
                    material="color: red; shader: standard"
                    position="-9.5 7 -5"
                    rotation="0 0 0"
                    
                    reset-button="">
        </a-entity>

        <a-entity id="walls"
                    obj-model="obj: #wallsObj"
                    material="src:assets/textures/WallsTexture.png;"
                    position="-1 -7 6"
                    rotation="0 0 0"
                    static-body>
        </a-entity>

        <a-entity id="ceiling"
                    obj-model="obj: #ceilingObj"
                    material="src:assets/textures/CeilingTexture.png;"
                    position="-1 -7 6"
                    rotation="0 0 0">
        </a-entity>

        <a-entity id="sidepipe"
                obj-model="obj: #sidepipeObj"
                material="src:assets/textures/Pipe_SupportTexture.png;"
                position="-1 -7 6"
                rotation="0 0 0">
        </a-entity>

        <a-entity id="pipe"
                obj-model="obj: #pipeObj"
                material="src:assets/textures/PipesTexture.png;"
                position="-1 -7 6"
                rotation="0 0 0">
        </a-entity>
        
        <a-entity id="vent"
                obj-model="obj: #ventObj"
                material="src:assets/textures/VentTexture.png;"
                position="-1 -7 6"
                rotation="0 0 0">
        </a-entity>
        
        <a-entity id="bucket"
                    obj-model="obj: #bucketObj"
                    material="color: purple; shader: standard"
                    position="-3.5 -5 5"
                    rotation="0 0 0"
                    static-body>
        </a-entity>

        <a-entity id="corkBoard"
                    obj-model="obj: #corkboardObj"
                    material="src:assets/textures/CorkBoardTexture.png;"
                    position="-1 -7 6"
                    rotation="0 0 0"
                    static-body>
        </a-entity>

        <a-entity id="table"
                    obj-model="obj: #tableObj"
                    material="src:assets/textures/TableTexture.png;"
                    position="-1 -7 6"
                    rotation="0 0 0"
                    static-body>
        </a-entity>

        <a-entity id="slide1"
          geometry="primitive: box; width: 2; height: 10; depth: 0.5"
                    material="color: blue; shader: standard"
                    position="-2.25 6 -5"
                    rotation="-75 90 0"
                    static-body>
        </a-entity>

        <a-entity id="slide2"
          geometry="primitive: box; width: 2; height: 10; depth: 0.5"
                    material="color: blue; shader: standard"
                    position="4 3 -5"
                    rotation="-120 90 0"
                    static-body>
        </a-entity>
        
        <a-entity id="slide3"
          geometry="primitive: box; width: 2; height: 6; depth: 0.5"
                    material="color: blue; shader: standard"
                    position="-3 1 -5"
                    rotation="-80 90 0"
                    static-body>
        </a-entity>

        <a-entity id="spot"
                    position="0 0 0"
        ></a-entity>

        <a-entity id="piece"
                    geometry="primitive: box; width: 2; height: 2; depth: 2"
                    class="clickable notgrab"
                    material="color: green; shader: standard"
                    position="8 1 0"
                    grabbing=""
                    static-body>
        </a-entity>
        <a-plane id="glass" position="0 0 -4.5" rotation="180 0 0" width="20" height="20" color= blue static-body></a-plane>

      </a-scene>

      <script src="/socket.io/socket.io.js"></script>
      <script>
        let socket = io();

        let counter = 0;

        //default connect event
        socket.on('connect', function() {
                console.log("connected!");
        });

        socket.on('generate_shape', function(data) {
          console.log("shape received");

          var z = Math.random() * 9 - 2.5;

          let createdShape = document.createElement('a-entity');
            createdShape.setAttribute('id', 'shape' + counter);

            createdShape.setAttribute('new-geo', '');
            createdShape.setAttribute('class', "clickable notgrab");
            createdShape.setAttribute('geometry', 'primitive: new-geo; vertices:' + data.verts);
            createdShape.setAttribute('position', '8.2 5 3'); 
            createdShape.setAttribute('rotation', '0 -90 0');
            createdShape.setAttribute('scale', '0.1 0.1 0.1');
            createdShape.setAttribute('animation', 'property: scale; to: 1 1 1; loop: false; dur: 700'); 
            createdShape.setAttribute('animation__2', 'property: position; to: 8.2 -0.9 0' + (z) + '; loop:false; dur: 1200');
             
            createdShape.addEventListener('loaded', function(){
                createdShape.setAttribute('material', 'color:' + data.material + "; side: double");
                createdShape.setAttribute('grabbing', '');
                createdShape.setAttribute('static-body', '');
            })
            
            counter++;

            let scene = document.querySelector('a-scene');
            scene.appendChild(createdShape);
        });


        
      
      </script>
    </body>
</html>